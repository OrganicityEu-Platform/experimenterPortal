<md-content layout-padding>

<div layout="row">
    <h2>Experiment Creation - Area</h2>
    <i class="material-icons" style="color:green;cursor:pointer;margin-left:20px" ng-click="vm.showInfo()">info</i>
</div>
    <div ng-show="vm.creatingRegion">
    <leaflet id="regionCreation" controls="controls" layers="layers" width="100%" height="50vh" lf-center="center">
    </leaflet>
    <br>
    <div layout="row">
    <md-radio-group ng-model="vm.options" layout="row" ng-init=" vm.options = 'default'">
        <md-radio-button value="default" class="md-primary">Default</md-radio-button>
        <md-radio-button value="advanced" class="md-primary">Advanced Options</md-radio-button>
    </md-radio-group>
    <i class="material-icons" style="color:blue;cursor:pointer; margin-top:10px;margin-left:20px" ng-click="vm.showInfoAdvance()">info</i>
    </div>
    <p ng-show="vm.infoAdvance" class="ep_info">The advanced options will let treat each region individually by setting
    specific start and end dates, define a generic importance rank of the regions and by defining accounting limits
    for each region. </p>
    <form name="vm.newRegionForm" novalidate>
        <md-input-container class="md-block">
            <label>Region Name</label>
            <input md-maxlength="40" required name="name" required ng-model="vm.newRegion.name">
            <div ng-messages="vm.newRegionForm.name.$error">
                <div ng-message="md-maxlength">Name is limited to 40 characters</div>
                <div ng-message="required">Name is required</div>
            </div>
        </md-input-container>
        <span layout="row" ng-if="vm.options === 'advanced'">
        <md-input-container class="md-block" style="width:300px; margin-right:20px;">
            <label ng-if="vm.browser==='firefox'">Start Date (yyyy-mm-dd)</label>
            <label ng-if="vm.browser!=='firefox'">Start Date</label>
            <input name="startDate" type="date" ng-model="vm.newRegion.startDate" min="{{vm.expStart}}" max="{{vm.expEnd}}"/>
            <div ng-messages="vm.newRegionForm.startDate.$error">
                <div ng-message="min">The region cannot start before the experiment</div>
                <div ng-message="min">The region cannot start after the experiment finishes</div>
            </div>
        </md-input-container>
        <md-input-container class="md-block" style="width:300px;">
            <label ng-if="vm.browser==='firefox'">End Date (yyyy-mm-dd)</label>
            <label ng-if="vm.browser!=='firefox'">End Date</label>
            <input name="endDate" type="date" ng-model="vm.newRegion.endDate" min="{{vm.newRegion.startDate}}" max="{{vm.expEnd}}"
            />
            <div ng-messages="vm.newRegionForm.endDate.$error">
                <div ng-message="min">The region cannot finish before the experiment starts</div>
                <div ng-message="min">The region cannot finish after the experiment</div>
            </div>
        </md-input-container>
        </span>
        <span layout="row" style="width:100%" ng-if="vm.options === 'advanced'">

        
        <md-input-container class="md-block" style=" margin-right:20px;">
            <label>Min</label>
            <input type="number" name="min" ng-model="vm.newRegion.min">
        </md-input-container>


        <md-input-container class="md-block" style=" margin-right:20px;">
            <label>Max</label>
            <input type="number" name="max" ng-model="vm.newRegion.max">
        </md-input-container>

        <md-input-container class="md-block">
            <label>Importance</label>
            <input type="string" name="max" ng-model="vm.newRegion.weight">
        </md-input-container>
         
        </span>
        
    </form>
    <br>
    <br>
    <md-button style="float:left" class="md-flat md-primary" ng-click="vm.cancelAddRegion()"> Cancel</md-button>
    <md-button style="float:right" class="md-flat md-primary" ng-disabled="vm.newRegionForm.$invalid || 
    vm.newRegion.coordinates.length === 0" ng-click="vm.addRegion()"> Add Region </md-button>
    </div>

    <div ng-show="!vm.creatingRegion">
    
    <br>
    <br>
    <md-button  class="md-flat md-secondary" ng-click="vm.createNewRegion()"> New Region </md-button>
    <br>
    <br>
    <table datatable="ng" dt-options="vm.dtOptions" dt-column-defs="vm.dtColumnDefs" class="row-border hover">
        <thead>
            <tr>
                <th align="left">Name</th>
                <th align="left">Start Date</th>
                <th align="left">End Date</th>
                <th align="left">Min</th>
                <th align="left">Max</th>
                <th align="left">Weigth</th>
                <th align="left"></th>
            </tr>
        </thead>
        <tbody>
            <tr ng-repeat="region in vm.regions">
                <td align="left">{{ region.name }}</td>
                <td align="left">{{ region.startDate| date:'MM/dd/yyyy' }}</td>
                <td align="left">{{ region.endDate| date:'MM/dd/yyyy' }}</td>
                <td align="left">{{ region.min }}</td>
                <td align="left">{{ region.max }}</td>
                <td align="left">{{ region.weight }}</td>
                <td ng-click="vm.remove($event, region)"></td>
            </tr>
        </tbody>
    </table>

    <span style="width:100%">
    <md-button style="float:left" class="md-flat md-primary" ng-click="vm.cancel()"> Cancel </md-button>
    <md-button style="float:right" class="md-flat md-primary" ng-click="vm.finish()"> Finish </md-button>
    </span>
    </div>

</md-content>